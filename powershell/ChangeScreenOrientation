$Base64String = "PCMgIDpjbWQgaGVhZGVyIGZvciBQb3dlclNoZWxsIHNjcmlwdA0KQCAgIHNldCBkaXI9JX5kcDANCkAgICBzZXQgcHMxPSIlVE1QJVwlfm4wLSVSQU5ET00lLSVSQU5ET00lLSVSQU5ET00lLSVSQU5ET00lLnBzMSINCkAgICBjb3B5IC9iIC95ICIlfmYwIiAlcHMxJSA+bnVsDQpAICAgcG93ZXJzaGVsbCAtTm9Qcm9maWxlIC1FeGVjdXRpb25Qb2xpY3kgQnlwYXNzIC1GaWxlICVwczElICUqDQpAICAgZGVsIC9mICVwczElDQpAICAgZ290byA6ZW9mDQojPg0KDQpGdW5jdGlvbiBTZXQtU2NyZWVuUmVzb2x1dGlvbkFuZE9yaWVudGF0aW9uIHsgDQoNCjwjIA0KICAgIC5TeW5vcHNpcyANCiAgICAgICAgU2V0cyB0aGUgU2NyZWVuIFJlc29sdXRpb24gb2YgdGhlIHByaW1hcnkgbW9uaXRvciANCiAgICAuRGVzY3JpcHRpb24gDQogICAgICAgIFVzZXMgUGludm9rZSBhbmQgQ2hhbmdlRGlzcGxheVNldHRpbmdzIFdpbjMyQVBJIHRvIG1ha2UgdGhlIGNoYW5nZSANCiAgICAuRXhhbXBsZSANCiAgICAgICAgU2V0LVNjcmVlblJlc29sdXRpb25BbmRPcmllbnRhdGlvbiAgICAgICAgIA0KICAgICAgICANCiAgICBVUkw6IGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTI2NDQ3ODYvcG93ZXJzaGVsbC1zY3JpcHQtdG8tY2hhbmdlLXNjcmVlbi1vcmllbnRhdGlvbj9hbnN3ZXJ0YWI9YWN0aXZlI3RhYi10b3ANCiAgICBDTUQ6IHBvd2Vyc2hlbGwuZXhlIC1FeGVjdXRpb25Qb2xpY3kgQnlwYXNzIC1GaWxlICIlfmRwMENoYW5nZU9yaWVudGF0aW9uLnBzMSINCiM+DQoNCiRwaW52b2tlQ29kZSA9IEAiIA0KDQp1c2luZyBTeXN0ZW07IA0KdXNpbmcgU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzOyANCg0KbmFtZXNwYWNlIFJlc29sdXRpb24gDQp7IA0KDQogICAgW1N0cnVjdExheW91dChMYXlvdXRLaW5kLlNlcXVlbnRpYWwpXSANCiAgICBwdWJsaWMgc3RydWN0IERFVk1PREUgDQogICAgeyANCiAgICAgICBbTWFyc2hhbEFzKFVubWFuYWdlZFR5cGUuQnlWYWxUU3RyLFNpemVDb25zdD0zMildDQogICAgICAgcHVibGljIHN0cmluZyBkbURldmljZU5hbWU7DQoNCiAgICAgICBwdWJsaWMgc2hvcnQgIGRtU3BlY1ZlcnNpb247DQogICAgICAgcHVibGljIHNob3J0ICBkbURyaXZlclZlcnNpb247DQogICAgICAgcHVibGljIHNob3J0ICBkbVNpemU7DQogICAgICAgcHVibGljIHNob3J0ICBkbURyaXZlckV4dHJhOw0KICAgICAgIHB1YmxpYyBpbnQgICAgZG1GaWVsZHM7DQogICAgICAgcHVibGljIGludCAgICBkbVBvc2l0aW9uWDsNCiAgICAgICBwdWJsaWMgaW50ICAgIGRtUG9zaXRpb25ZOw0KICAgICAgIHB1YmxpYyBpbnQgICAgZG1EaXNwbGF5T3JpZW50YXRpb247DQogICAgICAgcHVibGljIGludCAgICBkbURpc3BsYXlGaXhlZE91dHB1dDsNCiAgICAgICBwdWJsaWMgc2hvcnQgIGRtQ29sb3I7DQogICAgICAgcHVibGljIHNob3J0ICBkbUR1cGxleDsNCiAgICAgICBwdWJsaWMgc2hvcnQgIGRtWVJlc29sdXRpb247DQogICAgICAgcHVibGljIHNob3J0ICBkbVRUT3B0aW9uOw0KICAgICAgIHB1YmxpYyBzaG9ydCAgZG1Db2xsYXRlOw0KDQogICAgICAgW01hcnNoYWxBcyhVbm1hbmFnZWRUeXBlLkJ5VmFsVFN0ciwgU2l6ZUNvbnN0ID0gMzIpXQ0KICAgICAgIHB1YmxpYyBzdHJpbmcgZG1Gb3JtTmFtZTsNCg0KICAgICAgIHB1YmxpYyBzaG9ydCAgZG1Mb2dQaXhlbHM7DQogICAgICAgcHVibGljIHNob3J0ICBkbUJpdHNQZXJQZWw7DQogICAgICAgcHVibGljIGludCAgICBkbVBlbHNXaWR0aDsNCiAgICAgICBwdWJsaWMgaW50ICAgIGRtUGVsc0hlaWdodDsNCiAgICAgICBwdWJsaWMgaW50ICAgIGRtRGlzcGxheUZsYWdzOw0KICAgICAgIHB1YmxpYyBpbnQgICAgZG1EaXNwbGF5RnJlcXVlbmN5Ow0KICAgICAgIHB1YmxpYyBpbnQgICAgZG1JQ01NZXRob2Q7DQogICAgICAgcHVibGljIGludCAgICBkbUlDTUludGVudDsNCiAgICAgICBwdWJsaWMgaW50ICAgIGRtTWVkaWFUeXBlOw0KICAgICAgIHB1YmxpYyBpbnQgICAgZG1EaXRoZXJUeXBlOw0KICAgICAgIHB1YmxpYyBpbnQgICAgZG1SZXNlcnZlZDE7DQogICAgICAgcHVibGljIGludCAgICBkbVJlc2VydmVkMjsNCiAgICAgICBwdWJsaWMgaW50ICAgIGRtUGFubmluZ1dpZHRoOw0KICAgICAgIHB1YmxpYyBpbnQgICAgZG1QYW5uaW5nSGVpZ2h0Ow0KICAgIH07IA0KDQogICAgY2xhc3MgTmF0aXZlTWV0aG9kcyANCiAgICB7IA0KICAgICAgICBbRGxsSW1wb3J0KCJ1c2VyMzIuZGxsIildIA0KICAgICAgICBwdWJsaWMgc3RhdGljIGV4dGVybiBpbnQgRW51bURpc3BsYXlTZXR0aW5ncyhzdHJpbmcgZGV2aWNlTmFtZSwgaW50IG1vZGVOdW0sIHJlZiBERVZNT0RFIGRldk1vZGUpOyANCiAgICAgICAgW0RsbEltcG9ydCgidXNlcjMyLmRsbCIpXSANCiAgICAgICAgcHVibGljIHN0YXRpYyBleHRlcm4gaW50IENoYW5nZURpc3BsYXlTZXR0aW5ncyhyZWYgREVWTU9ERSBkZXZNb2RlLCBpbnQgZmxhZ3MpOyANCg0KICAgICAgICBwdWJsaWMgY29uc3QgaW50IEVOVU1fQ1VSUkVOVF9TRVRUSU5HUyA9IC0xOyANCiAgICAgICAgcHVibGljIGNvbnN0IGludCBDRFNfVVBEQVRFUkVHSVNUUlkgPSAweDAxOyANCiAgICAgICAgcHVibGljIGNvbnN0IGludCBDRFNfVEVTVCA9IDB4MDI7IA0KICAgICAgICBwdWJsaWMgY29uc3QgaW50IERJU1BfQ0hBTkdFX1NVQ0NFU1NGVUwgPSAwOyANCiAgICAgICAgcHVibGljIGNvbnN0IGludCBESVNQX0NIQU5HRV9SRVNUQVJUID0gMTsgDQogICAgICAgIHB1YmxpYyBjb25zdCBpbnQgRElTUF9DSEFOR0VfRkFJTEVEID0gLTE7DQogICAgICAgIHB1YmxpYyBjb25zdCBpbnQgRE1ET19ERUZBVUxUID0gMDsNCiAgICAgICAgcHVibGljIGNvbnN0IGludCBETURPXzkwID0gMTsNCiAgICAgICAgcHVibGljIGNvbnN0IGludCBETURPXzE4MCA9IDI7DQogICAgICAgIHB1YmxpYyBjb25zdCBpbnQgRE1ET18yNzAgPSAzOw0KICAgIH0gDQoNCg0KDQogICAgcHVibGljIGNsYXNzIFBybWFyeVNjcmVlblJlc29sdXRpb24gDQogICAgeyANCiAgICAgICAgc3RhdGljIHB1YmxpYyBzdHJpbmcgQ2hhbmdlUmVzb2x1dGlvbigpIA0KICAgICAgICB7IA0KDQogICAgICAgICAgICBERVZNT0RFIGRtID0gR2V0RGV2TW9kZSgpOyANCg0KICAgICAgICAgICAgaWYgKDAgIT0gTmF0aXZlTWV0aG9kcy5FbnVtRGlzcGxheVNldHRpbmdzKG51bGwsIE5hdGl2ZU1ldGhvZHMuRU5VTV9DVVJSRU5UX1NFVFRJTkdTLCByZWYgZG0pKSANCiAgICAgICAgICAgIHsNCg0KICAgICAgICAgICAgICAgIC8vIHN3YXAgd2lkdGggYW5kIGhlaWdodA0KICAgICAgICAgICAgICAgIGludCB0ZW1wID0gZG0uZG1QZWxzSGVpZ2h0Ow0KICAgICAgICAgICAgICAgIGRtLmRtUGVsc0hlaWdodCA9IGRtLmRtUGVsc1dpZHRoOw0KICAgICAgICAgICAgICAgIGRtLmRtUGVsc1dpZHRoID0gdGVtcDsNCg0KICAgICAgICAgICAgICAgIC8vIGRldGVybWluZSBuZXcgb3JpZW50YXRpb24gYmFzZWQgb24gdGhlIGN1cnJlbnQgb3JpZW50YXRpb24NCiAgICAgICAgICAgICAgICBzd2l0Y2goZG0uZG1EaXNwbGF5T3JpZW50YXRpb24pDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICBjYXNlIE5hdGl2ZU1ldGhvZHMuRE1ET19ERUZBVUxUOg0KICAgICAgICAgICAgICAgICAgICAgICAgLy9kbS5kbURpc3BsYXlPcmllbnRhdGlvbiA9IE5hdGl2ZU1ldGhvZHMuRE1ET18yNzA7DQogICAgICAgICAgICAgICAgICAgICAgICAvLzIwMTYtMTAtMjUvRUJQIHdyYXAgY291bnRlciBjbG9ja3dpc2UNCiAgICAgICAgICAgICAgICAgICAgICAgIGRtLmRtRGlzcGxheU9yaWVudGF0aW9uID0gTmF0aXZlTWV0aG9kcy5ETURPXzkwOw0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgIGNhc2UgTmF0aXZlTWV0aG9kcy5ETURPXzI3MDoNCiAgICAgICAgICAgICAgICAgICAgICAgIGRtLmRtRGlzcGxheU9yaWVudGF0aW9uID0gTmF0aXZlTWV0aG9kcy5ETURPXzE4MDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICBjYXNlIE5hdGl2ZU1ldGhvZHMuRE1ET18xODA6DQogICAgICAgICAgICAgICAgICAgICAgICBkbS5kbURpc3BsYXlPcmllbnRhdGlvbiA9IE5hdGl2ZU1ldGhvZHMuRE1ET185MDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICBjYXNlIE5hdGl2ZU1ldGhvZHMuRE1ET185MDoNCiAgICAgICAgICAgICAgICAgICAgICAgIGRtLmRtRGlzcGxheU9yaWVudGF0aW9uID0gTmF0aXZlTWV0aG9kcy5ETURPX0RFRkFVTFQ7DQogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHVua25vd24gb3JpZW50YXRpb24gdmFsdWUNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFkZCBleGNlcHRpb24gaGFuZGxpbmcgaGVyZQ0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgfQ0KDQoNCiAgICAgICAgICAgICAgICBpbnQgaVJldCA9IE5hdGl2ZU1ldGhvZHMuQ2hhbmdlRGlzcGxheVNldHRpbmdzKHJlZiBkbSwgTmF0aXZlTWV0aG9kcy5DRFNfVEVTVCk7IA0KDQogICAgICAgICAgICAgICAgaWYgKGlSZXQgPT0gTmF0aXZlTWV0aG9kcy5ESVNQX0NIQU5HRV9GQUlMRUQpIA0KICAgICAgICAgICAgICAgIHsgDQogICAgICAgICAgICAgICAgICAgIHJldHVybiAiVW5hYmxlIFRvIFByb2Nlc3MgWW91ciBSZXF1ZXN0LiBTb3JyeSBGb3IgVGhpcyBJbmNvbnZlbmllbmNlLiI7IA0KICAgICAgICAgICAgICAgIH0gDQogICAgICAgICAgICAgICAgZWxzZSANCiAgICAgICAgICAgICAgICB7IA0KICAgICAgICAgICAgICAgICAgICBpUmV0ID0gTmF0aXZlTWV0aG9kcy5DaGFuZ2VEaXNwbGF5U2V0dGluZ3MocmVmIGRtLCBOYXRpdmVNZXRob2RzLkNEU19VUERBVEVSRUdJU1RSWSk7IA0KICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGlSZXQpIA0KICAgICAgICAgICAgICAgICAgICB7IA0KICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBOYXRpdmVNZXRob2RzLkRJU1BfQ0hBTkdFX1NVQ0NFU1NGVUw6IA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAiU3VjY2VzcyI7IA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gDQogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE5hdGl2ZU1ldGhvZHMuRElTUF9DSEFOR0VfUkVTVEFSVDogDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeyANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJZb3UgTmVlZCBUbyBSZWJvb3QgRm9yIFRoZSBDaGFuZ2UgVG8gSGFwcGVuLlxuIElmIFlvdSBGZWVsIEFueSBQcm9ibGVtIEFmdGVyIFJlYm9vdGluZyBZb3VyIE1hY2hpbmVcblRoZW4gVHJ5IFRvIENoYW5nZSBSZXNvbHV0aW9uIEluIFNhZmUgTW9kZS4iOyANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IA0KICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDogDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeyANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJGYWlsZWQgVG8gQ2hhbmdlIFRoZSBSZXNvbHV0aW9uIjsgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSANCiAgICAgICAgICAgICAgICAgICAgfSANCg0KICAgICAgICAgICAgICAgIH0gDQoNCg0KICAgICAgICAgICAgfSANCiAgICAgICAgICAgIGVsc2UgDQogICAgICAgICAgICB7IA0KICAgICAgICAgICAgICAgIHJldHVybiAiRmFpbGVkIFRvIENoYW5nZSBUaGUgUmVzb2x1dGlvbi4iOyANCiAgICAgICAgICAgIH0gDQogICAgICAgIH0gDQoNCiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgREVWTU9ERSBHZXREZXZNb2RlKCkgDQogICAgICAgIHsgDQogICAgICAgICAgICBERVZNT0RFIGRtID0gbmV3IERFVk1PREUoKTsgDQogICAgICAgICAgICBkbS5kbURldmljZU5hbWUgPSBuZXcgU3RyaW5nKG5ldyBjaGFyWzMyXSk7IA0KICAgICAgICAgICAgZG0uZG1Gb3JtTmFtZSA9IG5ldyBTdHJpbmcobmV3IGNoYXJbMzJdKTsgDQogICAgICAgICAgICBkbS5kbVNpemUgPSAoc2hvcnQpTWFyc2hhbC5TaXplT2YoZG0pOyANCiAgICAgICAgICAgIHJldHVybiBkbTsgDQogICAgICAgIH0gDQogICAgfSANCn0gDQoNCiJAIA0KDQpBZGQtVHlwZSAkcGludm9rZUNvZGUgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgDQpbUmVzb2x1dGlvbi5Qcm1hcnlTY3JlZW5SZXNvbHV0aW9uXTo6Q2hhbmdlUmVzb2x1dGlvbigpIA0KfQ0KDQpTZXQtU2NyZWVuUmVzb2x1dGlvbkFuZE9yaWVudGF0aW9u"
$OutputFilePath = "C:\Temp\ChangeOrientation.ps1.cmd"
$Bytes = [System.Convert]::FromBase64String($Base64String)
[System.IO.File]::WriteAllBytes($OutputFilePath, $Bytes)
Start-Process cmd.exe -ArgumentList "/c C:\Temp\ChangeOrientation.ps1.cmd"
